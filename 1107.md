### **ARP 프로토콜**

#### 정의
같은 네트워크 대역에서 통신을 하기 위해 필요한 MAC 주소를 IP를 이용해 알아오는 프로토콜이다.

#### 특징
[MAC 주소 중복에 관한 문제](https://pcb4.tistory.com/3205)
직접적으로 네트워크 통신상에서 우리가 사용하는 일은 없음.
[MAC과 IP를 함께 사용하는 이유](https://www.netmanias.com/ko/post/qna/2978)
통신 했던 컴퓨터들의 주소는 ARP 테이블에 남는다. 이때 테이블은 영구적으로 기록되지 않는다.
3계층인데 같은 네트워크 대역에서만 쓰임
Padding : 최소 크기(60byte)를 충족시키기 위하여 의미 없는 값을 입력.

### **ARP의 구조**

총 28byte
- Hardware type : 2계층에서 사용할 프로토콜 - 다른 프로토콜도 있지만 주로 0001(이더넷)이 옴
- Protocol type : protocol address type 0800(IPv4)
- Hardware address length : MAC 주소 길이(06)
- Protocol address length : IP주소 길이(04)
- Opcode : request(0001)인지 response(0002)인지 구분 해주는 코드
- Source hardware address : 출발지 MAC 주소
- Source protocol address : 출발지 IP주소
- Destination hardware address : 목적지 MAC 주소
- Destination protocol address : 목적지 IP주소

-이더넷만 목적지가 먼저 / 나머지는 출발지가 먼저


### **ARP 프로토콜 통신 과정**
MAC주소를 알고자하는 기기를 대상으로 요청하고, 대상 기기로부터 응답을 받는 방식으로 이루어진다.
#### 요청
스위치를 통하여 요청. 
이더넷 : 브로드 캐스팅 (FF FF FF FF FF FF)
ARP : 요청 대상의 MAC주소를 알지 못하므로 00 00 00 00 00 00로 MAC주소를 입력.
#### 응답
스위치를 통하여 응답.
이더넷 : 유니 캐스팅 (응답 대상의 MAC 주소).
ARP : 응답 대상의 MAC주소를 알고 있으므로, 요청 기기의 MAC주소를 입력.






### IPv4 프로토콜 ### 

#### 정의
OSI 네트워크 계층에서 송수신 기기의 주소 지정 및 패킷 분할을 담당하는 프로토콜. 네번째 버전.

#### 특징
데이터의 전달을 보장하지는 않는다.
패킷 조각화에 대한 관여.


### IPv4의 구조

기본 20byte + 옵션이 붙을 경우 4byte씩 늘어남 (최대 10개)

Version(0.5byte) : 버전 4
Header length(0.5byte) : IP 헤더 길이/4(4비트라 표현가능한 수 0~15, IP의 길이는 20~60byte, 표현이 불가능하기에 길이에 나누기 4를 해줌)
Type of service(1byte) : 
현재는 쓰이지 않음. 0으로 비워둔다. 현재는 이 위치의 값을 이해할 수 있는 장비도 없음
Total length(2byte) : 페이로드까지 합한 전체 길이
Identification + IP flag + Fragment offset : 큰 데이터를 크기에 맞게 나누어 전송할 때 사용하는 값
-Identification(2byte) : 나누어진 작은 패킷들에게 동일한 ID를 부여하여 같은 데이터임을 알아보게 함
IP flag(3bit) : 첫 번째 값 사용x 항상 0, D-(don't fragment) 분열 0 미분열 1, M-(more fragment) 현재 조각이 마지막이면 0, 조각이 뒤에 더 있으면 1
Fragment offset(13bit) : IP는 전송 순서를 보장하지 않음, 따라서 패킷을 받은 PC가 offset 값을 보고 다시 조립할 수 있도록 앞선 패킷들의 누적 크기를 표시(앞 패킷 페이로드/8)
Time to live(1byte) : 라우터를 넘어갈 때마다 숫자가 1씩 줄어 0이되면 사라짐(window의 기본값 128/linux의 기본값 64)-무한루프 방지
Protocol(1byte) : 상위 프로토콜이 무엇인지 알려줌
Header checksum(2byte) : IP의 필드값들을 계산한 값, 패킷을 받는 PC에서 다시 계산하여 이 값과 맞춰봄으로써 유효함을 확인
Destination Address (4byte) : 도착지 주소.
Source Address (4byte) : 출발지 주소.











### ICMP

#### 정의
internet control message protocol 

#### 특징
오류 및 정보 메시지를 교환하는 데에 사용.
특정 대상까지의 연결 상태를 점검하여 알려줄 수 있음.


#### **ICMP의 구조**

type(1byte) : 대분류 - 0,8 3,11, 5 정도는 알아두자
0 응답
8 요청
3 목적지에 도달하지 못함(가는 경로상의 문제)
11 목적지엔 갔지만 응답을 받지 못함(상대방 문제) ex 방화벽
5 상대의 라우팅 테이블 수정
code(1byte) : 소분류

[ICMP 보충](https://run-it.tistory.com/31)



### **라우팅 테이블**

#### 정의
컴퓨터 네트워크에서 목적지 주소를 목적지에 도달하기 위한 네트워크 노선으로 변환 시키위한 테이블.


#### 특징
[*/24는 뭘까?](https://oktopbang.tistory.com/entry/ip%EC%A3%BC%EC%86%8C-%ED%91%9C%EC%8B%9C%ED%95%A0%EB%95%8C-%EB%92%A4%EC%97%90-%EC%93%B0%EB%8A%94-24-25-26)
♨ 공인 ip의 서브넷 마스크?
